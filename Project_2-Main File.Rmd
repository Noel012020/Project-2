---
title: "Project 2"
authors: "Noel Pop and Georgia Cameron"
date: "10/31/2025"
output:
  pdf_document
subtitle: "CPSC 292 Section #02#"
---

# Project 1: Best-Selling Video Games of All Time

```{r setup, include = FALSE}
#Loading required libraries
library(tinytex)
library(tidyr)
library(janitor)
library(readxl)
library(lubridate)
library(ggplot2)
library(dplyr)
library(paletteer)
library(patchwork)
```

## Loading And Cleaning Data
```{r}
game.data <- read.csv("game.data/best-selling video games of all time.csv")
game.data
```

```{r}
game.data.clean <- game.data %>%
clean_names() %>%
remove_empty(which = c("rows","cols")) %>%
na.omit(game.data) %>%
mutate(sales = sales / 100000)
game.data.clean

platforms <- sort(unique(game.data.clean$platform_s))
label_df <- data.frame(platform_s = platforms, median_sales = NA)
```
### Cleaning Steps Description:
This cleans the data names, removes any empty columns or rows, and omits any NA data.

## Visualization

### First Analysis:
```{r}
plot1 <- ggplot(game.data.clean) + geom_boxplot(aes(x = platform_s, y = sales, fill = platform_s)) + theme(legend.position = "none", axis.title.x = element_text(face = "bold"), axis.title.y = element_text(face = "bold"), plot.title = element_text(face = "bold")) + labs(title = "Number Of Sales of Best-Selling Games On Each Platform", x = "Platform", y = "Number of Sold Copies (x100000)") + scale_fill_paletteer_d("MetBrewer::Signac") + coord_flip()
plot1
```
### First Analysis Description:
These plots shows us different platforms that the most sold video games of all time uses.

### Second Analysis:
```{r}
color.base <- paletteer::paletteer_d("MetBrewer::Signac")
color <- rep(color.base, length.out = 18)
plot2 <- ggplot(game.data.clean) + geom_bar(aes(x = publisher_s, fill = publisher_s)) + theme(legend.position = "none", axis.title.x = element_text(face = "bold"), axis.title.y = element_text(face = "bold"), plot.title = element_text(face = "bold")) + labs(title = "How Many Best-Selling Games Sold By Each Publisher", x = "Publisher", y = "Number of Games", fill = "Publisher") + scale_fill_manual(values = color, name = "Publisher") + coord_flip()
plot2
```
### Second Analysis Description:
These plots show us how many of the best selling video games of all time belong to each publisher.


### Plot 1 with Function
```{r}
make_plot <- function(data, x_var, y_var, geom_layer) {
  ggplot(data, aes_string(x = x_var, y = y_var, fill = x_var)) + 
    geom_layer(width = 0.5) +
    theme(
      legend.position = "none",
      axis.title.x = element_text(face = "bold"),
      axis.title.y = element_text(face = "bold"),
      plot.title = element_text(face = "bold")
    ) +
    coord_flip()
}

plot1 <- make_plot(game.data.clean, "platform_s", "sales", geom_boxplot) 

plot1 <- plot1 +
  labs(title = "Number Of Sales of Best-Selling Games On Each Platform", 
      x = "Platform", 
      y = "Number of Sold Copies (x100000)") +
  scale_fill_paletteer_d("MetBrewer::Signac") +
  scale_x_discrete(expand = expansion(mult = c(0.05, 0.1)))


for (i in seq_along(platforms)) {
  p <- platforms[i]
  label_df$median_sales[i] <- median(
    game.data.clean$sales[game.data.clean$platform_s == p],
    na.rm = TRUE
  )
}

label_df

plot1_with_medians <- plot1 +
  geom_text(
    data = label_df,
    aes(x = platform_s,
        y = median_sales,
        label = round(median_sales, 1)),
    color = "black",
    size = 2.5,
    vjust = -1.25,
    hjust = 0.50
  )

plot1_with_medians
```

### Plot 2 with Function and Conditional
```{r}

plot2 <- make_plot(game.data.clean, "publisher_s", geom_layer = geom_bar) +
  labs(
    title = "How Many Best-Selling Games Sold By Each Publisher",
    x = "Publisher",
    y = "Number of Games",
    fill = "Publisher"
  ) + 
  scale_fill_manual(values = color) +
  geom_text(
    stat = "count",
    aes(label = ifelse(after_stat(count) > 1, after_stat(count), "")),
    vjust = 0.3,
    hjust = -0.75,
    size = 2
  )

plot2
```

## References
https://dplyr.tidyverse.org/
https://ianadamsresearch.com/post/using-ggplot2-to-visualize-the-frequency-of-your-name/
https://github.com/thomasp85/patchwork#patchwork
https://www.sthda.com/english/wiki/bar-plots-r-base-graphs
https://exts.ggplot2.tidyverse.org/gallery/ 
https://r-graph-gallery.com/ggplot2-color.html




